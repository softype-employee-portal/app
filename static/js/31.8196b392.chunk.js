(this.webpackJsonpSoftypeHR=this.webpackJsonpSoftypeHR||[]).push([[31],{1297:function(e,t,a){"use strict";a.r(t);var n=a(8),l=a.n(n),r=a(15),c=a(40),s=a(1),o=a.n(s),u=a(23),i=a(4),m=a(20),d=a(59),p=a(5),b=a(45),E=a(28),f=a(34),O=function(e){var t=e.show,a=(e.onClearFilter,Object(u.c)()),n=Object(s.useState)(!1),m=Object(c.a)(n,2),d=m[0],p=m[1],O=Object(s.useState)(b.m),g=Object(c.a)(O,2),j=g[0],y=g[1],v=Object(s.useState)({}),h=Object(c.a)(v,2),k=(h[0],h[1]),w=function(e){var t=e.target,a=t.name,n=t.value,l=Object(E.w)(j);l[a]=n,y(l)},C=function(e,t){Object(E.g)(a,{type:e,message:t})},q=function(){var e=Object(r.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),C("info","Please wait"),k(j),e.next=5,Object(f.l)(a,j);case 5:t=e.sent,p(!1),t.error?C("error",t.message):C("success","Success");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.t,{show:t},o.a.createElement(i.cb,{className:"pt-4"},o.a.createElement(i.s,null,o.a.createElement(i.h,null,o.a.createElement(i.i,null,o.a.createElement(i.cb,null,o.a.createElement(i.s,Object.assign({},Object(E.v)("3"),{className:"float-right"}),o.a.createElement(i.E,null,o.a.createElement(i.R,{htmlFor:"date-input",className:"font-weight-bold"},o.a.createElement("span",null,"Year")),o.a.createElement(i.db,{className:"input-sm",size:"sm",name:"year",value:j.year,id:"year",onChange:w},o.a.createElement("option",{value:"",hidden:!0},"Select"),o.a.createElement("option",{value:"All"},"All"),o.a.createElement("option",{value:j.year,hidden:!0},j.year),b.s.map((function(e){return o.a.createElement("option",{key:e,value:+e},e)}))))),o.a.createElement(i.s,Object.assign({},Object(E.v)("3"),{className:"float-right"}),o.a.createElement(i.E,null,o.a.createElement(i.R,{className:"font-weight-bold"},o.a.createElement("span",null,"Month")),o.a.createElement(i.db,{className:"input-sm",size:"sm",name:"month",value:j.month,id:"month",onChange:w},o.a.createElement("option",{value:"",hidden:!0},"Select"),o.a.createElement("option",{value:j.month,hidden:!0},j.month),o.a.createElement("option",{value:"All"},"All"),b.k.map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))))),o.a.createElement(i.s,Object.assign({},Object(E.v)("3"),{className:"float-right"}),o.a.createElement(i.E,null,o.a.createElement(i.R,{htmlFor:"status",className:"font-weight-bold"},o.a.createElement("span",null,"Status:")),o.a.createElement(i.db,{custom:!0,className:"input-sm",size:"sm",name:"status",value:j.status,id:"status",onChange:w},o.a.createElement("option",{value:"",hidden:!0},j.status),o.a.createElement("option",{value:"All"},"All"),Object.keys(b.r).map((function(e){return o.a.createElement("option",{key:e,value:+e},0===Number(e)?"Closed":"Open")}))))),o.a.createElement(i.s,Object(E.v)("3"),o.a.createElement(i.cb,{gutters:!1},o.a.createElement(i.s,null,o.a.createElement(i.E,{className:"my-0"},o.a.createElement(i.R,{htmlFor:"date-input",className:"font-weight-bold mb-1"}),o.a.createElement(i.f,{disabled:d,block:!0,size:"sm",color:"info",className:"mt-2",onClick:q},"Apply"))),o.a.createElement(i.s,{className:"ml-1"},o.a.createElement(i.E,{className:"my-0"},o.a.createElement(i.R,{htmlFor:"date-input",className:"font-weight-bold mb-1"}),o.a.createElement(i.f,{disabled:d,block:!0,size:"sm",color:"danger",className:"mt-2",onClick:function(){y(b.m),q()}},"Clear"))))))))))))},g=(a(71),{employeeId:null,name:"",item:"",quantity:0,description:"",purpose:"",price:0,total_price:0}),j=a(24),y=a(716),v=a.n(y),h=a(64),k=a.n(h),w=function(){var e={item:!1,quantity:!1,date_needed:!1,price:!1,purpose:!1},t=Object(u.c)(),a=Object(s.useState)(!1),n=Object(c.a)(a,2),m=n[0],b=n[1],O=Object(s.useState)(g),y=Object(c.a)(O,2),h=y[0],w=y[1],C=Object(s.useState)(e),q=Object(c.a)(C,2),R=q[0],S=q[1],N=Object(u.d)((function(e){var t=e.appState.auth.user;return{firstname:t.firstname,lastname:t.lastname,employeeId:t.employeeId,userId:t.userId}}));g.name="".concat(Object(E.z)(N.firstname)," ").concat(Object(E.z)(N.lastname)),g.employeeId=N.employeeId;var _=function(t){S(e);var a=t.target.name,n=t.target.value,l=Object(E.w)(h);l[a]=n;var r=l.price*l.quantity;l.total_price=r>0?r:0,w(l)},I=function(){var e=k()(h.date_needed).isSameOrAfter(k()()),t={},a=h.item,n=h.quantity,l=h.date_needed,r=h.price,c=h.purpose;a||(t.item=!0),n<1&&(t.quantity=!0),l&&e||(t.date_needed=!0),r<1&&(t.price=!0),c||(t.purpose=!0),S(t),v.a.values(t).includes(!0)||D.current.toggle()},T=function(){var e=Object(r.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(E.g)(t,{type:"info",message:"Please wait"}),b(!0),e.next=4,j.a.post("/create_officeRequest ",h);case 4:a=e.sent,b(!1),a.error?Object(E.g)(t,{type:"error",message:a.message}):(t(Object(p.b)(p.a.ADD_TICKET,Object(E.r)(a.data.officeRequest_information[0]))),Object(f.k)(t),F.current.toggle(),A());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(e){var t="";switch(e){case"date_needed":t="Invalid date";break;case"quantity":t="Invalid Quantity";break;case"price":t="Invalid Price";break;case"item":t="Item is required"}return o.a.createElement(i.Q,{className:"help-block"},t)},A=function(){S(e),w(g)},F=Object(s.useRef)(),D=Object(s.useRef)();return o.a.createElement(d.f,Object.assign({ref:F},{title:"New Request",footer:o.a.createElement(o.a.Fragment,null,o.a.createElement(d.e,{isLoading:m,submit:I,btnText:"Submit"})),modalOnClose:A,cancelBtnTitle:"Close"}),o.a.createElement(d.b,Object.assign({id:"cutom_dialog",ref:D},{onConfirm:function(){D.current.toggle(),T()},title:"Please confirm."})),o.a.createElement(i.E,null,o.a.createElement(i.R,null,"Requestor : "),o.a.createElement(i.J,{id:"name",value:h.name,disabled:!0})),o.a.createElement(i.E,null,o.a.createElement(i.R,null,"Item : "),o.a.createElement(i.J,{name:"item",onChange:_,invalid:R.item,placeholder:"name/brand ect.",value:h.item||""}),x("item")),o.a.createElement(i.E,{row:!0,className:"my-0"},o.a.createElement(i.s,{xs:"6"},o.a.createElement(i.E,null,o.a.createElement(i.R,null,"Price per item : "),o.a.createElement(i.J,{type:"number",name:"price",value:h.price,onChange:_,invalid:R.price,placeholder:"0.00"}),x("price"))),o.a.createElement(i.s,{xs:"6"},o.a.createElement(i.E,null,o.a.createElement(i.R,null,"Quantity : "),o.a.createElement(i.J,{type:"number",name:"quantity",value:h.quantity,onChange:_,invalid:R.quantity,placeholder:"0"}),x("quantity")))),o.a.createElement(i.E,null,o.a.createElement(i.R,null,"Total Price : "),o.a.createElement(i.J,{id:"name",value:h.total_price,disabled:!0})),o.a.createElement(i.E,null,o.a.createElement(i.R,{htmlFor:"textarea-input"},"Purpose : "),o.a.createElement(i.rb,{onChange:_,name:"purpose",value:h.purpose,invalid:R.purpose,rows:"5"}),o.a.createElement(i.Q,{className:"help-block"},"Please provide a valid information")),o.a.createElement(i.E,null,o.a.createElement(i.R,{htmlFor:"date-input"},"Date Needed : "),o.a.createElement(i.J,{type:"date",onChange:_,name:"date_needed",invalid:R.date_needed,placeholder:"Date Needed"}),x("date_needed")))},C=function(e){e.id,e.name;var t=e.person_in_charge,a=(void 0===t&&e["person in charge"],e.item,e.quantity,e.description,e.status,e.remarks,e.date_requested),n=(void 0===a&&e["date requested"],e.resolved_date),l=(void 0===n&&e["resolve date"],Object.entries(e));return o.a.createElement(i.cb,null,o.a.createElement(i.s,null,o.a.createElement(i.i,null,o.a.createElement("table",{className:"table table-hover ",style:{borderBottom:"1px solid grey"}},o.a.createElement("tbody",null,l.map((function(e,t){var a=Object(c.a)(e,2),n=a[0],l=a[1];return null!==l&&"id"!==n&&""!==l&&o.a.createElement("tr",{key:t.toString()},o.a.createElement("td",{className:"text-capitalize"},"  ","".concat(Object(E.y)(Object(E.x)(n)),":")),o.a.createElement("td",null,o.a.createElement("b",null,o.a.createElement("p",null,function(e,t){return"status"===e.toLowerCase()?0===t?"Closed":"Open":"date requested"===e.toLowerCase()?Object(E.j)(new Date(t)):t}(n,l)))))})))))))};a(53),t.default=function(e){var t=Object(u.c)(),a=Object(s.useState)("All"),n=Object(c.a)(a,2),g=n[0],y=n[1],h=Object(s.useState)(!0),k=Object(c.a)(h,2),q=k[0],R=k[1],S=Object(s.useState)(),N=Object(c.a)(S,2),_=N[0],I=N[1],T=Object(s.useState)(!1),x=Object(c.a)(T,2),A=x[0],F=x[1],D=Object(s.useState)(!1),P=Object(c.a)(D,2),z=P[0],J=P[1],L=Object(s.useState)(!1),B=Object(c.a)(L,2),Q=B[0],H=B[1],K=Object(s.useState)(new Date),M=Object(c.a)(K,2),V=(M[0],M[1],Object(s.useState)(!1)),Y=Object(c.a)(V,2),G=(Y[0],Y[1],{year:b.g,month:b.e,status:"All"}),U=Object(s.useState)(G),W=Object(c.a)(U,2),X=W[0],Z=W[1],$=Object(s.useRef)(),ee=Object(s.useRef)(),te=Object(u.d)((function(e){var t=e.appState.auth.user;return{firstname:t.firstname,lastname:t.lastname,employeeId:t.employeeId,userId:t.userId,accountType:t.accountType}})),ae=Object(u.d)((function(e){return e.appState.ticket.ticket_requests})),ne=Object(s.useState)(),le=Object(c.a)(ne,2),re=le[0],ce=le[1],se=function(e,t){return e[t]},oe=function(e){I(e),$.current.toggle()},ue=function(){var e=Object(r.a)(l.a.mark((function e(){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={officeRequestId:_.id,employeeId:te.employeeId,indicator:z?1:0},Object(E.g)(t,{type:"info",message:"Please wait"}),e.next=4,j.a.post("/close_officeRequest",a);case 4:(n=e.sent).error?Object(E.g)(t,{type:"error",message:n.message}):(t(Object(p.b)(p.a.CLOSE_TICKET,Object(E.r)(n.data.officeRequest_information[0]))),Object(f.k)(t)),J(!1),H(!1),F(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(r.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/delete_officeRequest",{id:_.id});case 2:(a=e.sent).error?Object(E.g)(t,{type:"error",message:a.message}):(t(Object(p.b)(p.a.DELETE_TICKET),_.id),Object(f.k)(t)),J(!1),H(!1),F(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){ce(ae)}),[ae]),o.a.createElement(i.cb,null,o.a.createElement(i.s,{xl:12},o.a.createElement(d.b,Object.assign({ref:ee},{show:ee,centered:!0,onConfirm:Q?ie:ue,title:"".concat(z?"Approve":A?"Reject":Q?"Delete":""," request?"),onCloseCallback:function(){$.current.toggle(),J(!1),F(!1),H(!1)}})),o.a.createElement(d.f,{ref:$,centered:!0,title:"Request Details",modalOnClose:oe,hidden:!0,closeButton:!0,footer:_&&1===_.status&&1===te.accountType?o.a.createElement(o.a.Fragment,null,o.a.createElement(i.f,{color:"success",onClick:function(){J(!0),$.current.toggle(),ee.current.toggle()}},"Approve"),o.a.createElement(i.f,{color:"danger",onClick:function(){F(!0),$.current.toggle(),ee.current.toggle()}},"Reject")):2===te.accountType||3===te.accountType?o.a.createElement(o.a.Fragment,null,o.a.createElement(i.f,{color:"danger",onClick:function(){H(!0),$.current.toggle(),ee.current.toggle()}},"Delete Request")):"",hideCancelButton:!0},o.a.createElement(C,_)),o.a.createElement(i.h,null,o.a.createElement(i.i,null,o.a.createElement(i.cb,null,o.a.createElement(i.s,{sm:"5"},o.a.createElement("h4",{className:"card-title mb-0"},1===Number(g)?"Open":"All"===g?g:"Closed"," Requests")),o.a.createElement(i.s,{sm:"7",className:"d-none d-md-block"},o.a.createElement("div",{className:"float-right  mr-3"},o.a.createElement(w,null)),o.a.createElement("div",{className:"float-right mr-3 ".concat(!q&&"mb-2")},o.a.createElement(i.f,{color:"".concat(q?"secondary":"primary"),onClick:function(e){R(!q),e.preventDefault()},className:"mb-1"},q?"Hide":"Show "," Filter",o.a.createElement(m.b,{size:"sm",name:"".concat(q?"cil-chevron-top":"cil-chevron-bottom")}))))),o.a.createElement(i.cb,null,o.a.createElement(i.s,null,o.a.createElement(O,{show:q,onStatusChange:function(e){y(e.target.value)},filter:X,onClearFilter:function(){Z(G),ce(ae)}}))),o.a.createElement(i.w,{items:1===te.accountType?re:3===te.accountType||2===te.accountType?v.a.filter(re,["requestor",te.employeeId]):[],fields:[{key:"transaction no",label:"request no."},{key:"date requested",_style:{width:"15%"}},{key:"name",label:"Requestor",_style:{width:"15%"}},{key:"item",_style:{width:"15%"}},{key:"price"},{key:"quantity"},{key:"total price",label:"Total"},{key:"status"},{key:"date needed"}],itemsPerPage:5,hover:!0,pagination:!0,onRowClick:oe,clickableRows:!0,noItemsViewSlot:o.a.createElement(d.g,null),scopedSlots:{"date requested":function(e){return o.a.createElement("td",null,e["date requested"])},status:function(e){return o.a.createElement("td",null,o.a.createElement(i.b,{color:se(b.r,e.status)},1===e.status?"Open":"Closed"))}}})))))}}}]);
//# sourceMappingURL=31.8196b392.chunk.js.map